echo "üìã Validating commit message..."

npx --no -- commitlint --edit ${1}
COMMITLINT_EXIT_CODE=$?

if [ $COMMITLINT_EXIT_CODE -ne 0 ]; then
  echo ""
  echo "‚ùå Commit message does not follow the convention."
  echo ""
  echo "Expected format:"
  echo "  <type>(<scope>): <subject>"
  echo ""
  echo "Examples:"
  echo "  feat(auth): add Google OAuth provider"
  echo "  fix(auth): handle expired Apple token"
  echo "  refactor(config): extract Redis config to separate file"
  echo "  test(auth): add JWT service unit tests"
  echo "  docs(readme): update setup instructions"
  echo "  chore(deps): upgrade NestJS to v10.3"
  echo ""
  echo "Allowed types: feat, fix, refactor, test, docs, chore, style, perf, ci, build, revert"
  echo "Allowed scopes: auth, config, redis, health, database, common, deps, release"
  echo ""
  exit 1
fi

echo "‚úÖ Commit message is valid."
echo ""